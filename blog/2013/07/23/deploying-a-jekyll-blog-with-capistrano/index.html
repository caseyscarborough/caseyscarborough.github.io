<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Deploying a Jekyll Blog with Capistrano &middot; caseyscarborough.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/favicon.ico" type="image/png">

    <link href="/assets/stylesheets/app-d69b7bfe.css" rel="stylesheet" type="text/css" />
    <script src="/assets/javascripts/app-693e4d68.js" type="text/javascript"></script>
</head>
    <body>

    <div id="wrap">
      <header class="navbar navbar-inverse navbar-fixed-top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".cs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">CASEY SCARBOROUGH</a>
    </div>
    <nav class="collapse navbar-collapse cs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li><a href="/">Home</a></li>
        <li><a href="/about/">About</a></li>
        <li><a href="https://github.com/caseyscarborough" target="_blank">GitHub</a></li>
        <li><a href="/blog/">Blog</a></li>
        <li><a href="/activity/">Activity</a></li>
      </ul>
    </nav>
  </div>
</header>

      <div class="content">
        <br>
        <div class="container">
          <div class="row">
            <div class="col-md-2 hidden-sm"></div>
            <div class="col-md-8">
              <h2>Deploying a Jekyll Blog with Capistrano</h2>
              <p class="meta">23 Jul 2013 &middot; By <a href="mailto:caseyscarborough@gmail.com">Casey Scarborough</a></p>

              <div class="post">
                <p>A large majority of sites built using Jekyll end up being hosted using <a href="http://pages.github.com/">GitHub Pages</a>. I opted to host this blog myself, and wanted the convenience I&#39;ve had in the past with Rails applications of deploying with <a href="http://www.capistranorb.com/">Capistrano
</a>. The first thing you&#39;ll want to do is be sure that you have the Capistrano gem installed on your system.</p>

<pre><code class="bash">gem install capistrano
gem install rvm-capistrano
</code></pre>

<p>Afterwards, <code>cd</code> to your blog&#39;s directory and initialize the directory using Capistrano&#39;s <code>capify</code> command.</p>

<pre><code class="bash">cd /path-to/jekyll-blog
capify .
</code></pre>

<p>This will generate a file named <code>Capfile</code> and a directory called <code>config</code> with a <code>deploy.rb</code> script inside. The following is a sample <code>deploy.rb</code> script based on the one I used for my blog to deploy the blog to your remote server. Replace the contents of your <code>deploy.rb</code> script with this and edit the values as necessary.</p>

<pre><code class="ruby">set :rvm_ruby_string, &#39;default&#39;require &quot;rvm/capistrano&quot;

# Set application name and username on server
set :application, &quot;blog.caseyscarborough.com&quot;
set :user, &quot;username-on-server&quot;

# Set SSH Port and location on the server to deploy to
set :port, 22
set :deploy_to, &quot;/var/www/#{application}&quot;
set :deploy_via, :copy
set :use_sudo, false

# Set git as the SCM and set the repository and branch
set :scm, :git
set :repository, &quot;https://github.com/caseyscarborough/blog.caseyscarborough.com&quot;
set :branch, &quot;master&quot;

# Set the hostname or IP of the server to deploy to
role :web, &quot;123.456.7.890&quot;
role :app, &quot;123.456.7.890&quot;
role :db,  &quot;123.456.7.890&quot;, :primary =&gt; true
role :db,  &quot;123.456.7.890&quot;

# Remove the config dir and Capfile, and run jekyll build
after &quot;deploy:create_symlink&quot; do
  run &quot;rm -rf #{release_path}/config #{release_path}/Capfile&quot;
  run &quot;cd #{release_path} &amp;&amp; jekyll build&quot;
end
</code></pre>

<p>Afterwards, you can run the typical Capistrano commands from the root of your blog directory to deploy the application. Make sure that you have the <code>jekyll</code> gem installed on your remote server before this step.</p>

<pre><code class="bash">cap deploy:setup
cap deploy:check
cap deploy
</code></pre>

<p>Your blog should then be deployed to the remote server and <code>jekyll build</code> will be run on your blog to generate the static content.</p>

<p>The last step is to make sure that your Virtual Host configuration for your web server points to the _site directory at the deployed location on your server. Here is a sample nginx configuration for the Virtual Host:</p>

<pre><code>server {
  listen 80;
  server_name example.com;
  root /var/www/example.com/current/_site;
}
</code></pre>

<p>This way, every time you make a change you can deploy the blog and it will update automatically.</p>

              </div>
              <br>
                <div class="comments">
                  <div id="disqus_thread"></div>
                  <script type="text/javascript">
                    var disqus_shortname = 'caseyscarboroughcom'; 
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  </script>
                  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
  <div class="row">
    <div class="col-md-3 hidden-sm"></div>
    <div class="col-md-6">
      <div class="footer">
        <p class="pull-left icons">
          <a target="_blank" class="tooltip-link" title="Email" href="mailto:caseyscarborough@gmail.com"><i class="fa fa-envelope"></i></a>&nbsp;&nbsp;
          <a target="_blank" class="tooltip-link" title="GitHub" href="https://github.com/caseyscarborough/"><i class="fa fa-github"></i></a>&nbsp;&nbsp;
          <a target="_blank" class="tooltip-link" title="BitBucket" href="https://bitbucket.org/caseyscarborough/"><i class="fa fa-bitbucket"></i></a>&nbsp;&nbsp;
          <a target="_blank" class="tooltip-link" title="LinkedIn" href="https://linkedin.com/in/caseyscarborough"><i class="fa fa-linkedin"></i></a>&nbsp;&nbsp;
          <a target="_blank" class="tooltip-link" title="Google+" href="https://plus.google.com/103526747321763836028?rel=author"><i class="fa fa-google-plus"></i></a>
        </p>
        <p class="pull-right">
          <small class="meta">Contribute to this site on <a target="_blank" href="https://github.com/caseyscarborough/caseyscarborough.github.io">GitHub</a>.</small><br>
        </p>
      </div>
    </div>
  </div>
</div>
    </body>
</html>
